@import uk.gov.hmrc.awrslookup._
@import uk.gov.hmrc.awrslookup.models._
@import uk.gov.hmrc.play.views.html.helpers._
@import views.html._
@import helpers._
@import lookup.results._
@import java.net.URLEncoder


@(result: AwrsEntry, id: String, searchTerm: String)(implicit request: Request[AnyContent], messages: Messages)

@encodeString(query: String) = @{
    URLEncoder.encode(query, "UTF-8").replaceAll("\\+", "%20")
}

@address = @{
    result match {
        case _: Business => result.info.address.toStringSeq.mkString(", ")
        case asGroup: Group => groupSearchBestMatchAddress(asGroup, searchTerm).toStringSeq.mkString(", ")
    }
}

@resultNameToDisplay = @{
    result match {
        case _: Business => bestMatchName(result.info, searchTerm)
        case asGroup: Group => groupSearchBestMatchInfo(asGroup, searchTerm)
    }
}

<div class="form-group">
    <a class="result-link" id="result_@id" href="@controllers.routes.LookupController.show(fromMulti = true)?originalSearchTerm=@{encodeString(searchTerm)}&query=@{result.awrsRef}">
        <h3 class="heading-medium-search">@resultNameToDisplay</h3>
    </a>
    @headerRegNumberHighlight(result, attrClass = "form-hint", id = id)
    <p id="address_@id">@address</p>
</div>
