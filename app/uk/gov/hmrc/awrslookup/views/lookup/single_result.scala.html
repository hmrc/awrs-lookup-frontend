@import uk.gov.hmrc.play.views.html.helpers._
@import uk.gov.hmrc.awrslookup._
@import uk.gov.hmrc.awrslookup.models._
@import views.html._
@import helpers._
@import lookup.results._
@import common._
@import lookup.search._

@(searchForm : Form[models.Query], action: Call, result: models.AwrsEntry, searchTerm: String, fromMulti: Boolean = false, originalSearchTerm: Option[String] = None)(implicit request: Request[AnyContent], messages: Messages)

@cssScripts = {
    <link rel="stylesheet" href=@routes.Assets.at("stylesheets/custom.css")>
}

@heading = {
    @result match {
        case  bus : Business => { @knownName(bus.info) }
        case  grp : Group    => { @whichHeading(grp) }
    }
}

@whichHeading(group: Group) = {
    @fromMulti match {
        case true => {@groupSearchBestMatchInfo(group, originalSearchTerm.get)}
        case _ => {@knownName(group.info)}
    }
}

@searchbar = {
<div class="search">
    @awrsInputTypeText(
    field = searchForm("query"),
    inputClass = "search-awrs",
    parentForm = searchForm,
    maxLength = 140,
    postInputContent = search_button(id = "search", classAttr = None),
    label = Messages("awrs.lookup.search.label"),
    labelClass = "visuallyhidden"
    )
</div>
}

@views.html.main_template(title = heading.toString, bodyClasses = None, contentHeader = cssScripts) {
    <div class="grid">
        @backLink()
        @helper.form(action = action) {
        @searchbar
        }
        <div>@awrs_entry(result, "result", searchTerm, fromMulti, originalSearchTerm, heading.toString)</div>
        @searchDate()
        @status_approved(result)
        @awrsPrintLink()
    </div>
}